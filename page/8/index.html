<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>建均笔记</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="建均笔记">
<meta property="og:url" content="http://www.uto.ink/page/8/index.html">
<meta property="og:site_name" content="建均笔记">
<meta property="og:locale">
<meta property="article:author" content="建均笔记">
<meta name="twitter:card" content="summary">
  
  <meta name="keywords" content="建均笔记">
  
  
    <link rel="alternative" href="/atom.xml" title="建均笔记" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<script>
(function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<!-- baidu Analytics -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b5a8646d4b9e56cf6ef835a8e416f147";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
<!-- End baidu Analytics -->


<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css" />
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/avatar.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">建均笔记</a></h1>
		</hgroup>

		
		<p class="header-subtitle">不积跬步 无以至千里</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>

				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/about">关于我</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/stotem" title="github">github</a>
					        
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
								<a class="mail" target="_blank" href="mailto:china.wujianjun@icloud.com" title="mail">mail</a>
					        
						</div>
						<div>
							<i class="fa fa-line-chart"></i>
							本站访问量<span id=“busuanzi_container_site_pv”><span id="busuanzi_value_site_pv"><i class="fa fa-spinner fa-spin"></i></span></span> 次
						</div>
					</nav>
				</section>

				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Docker/" style="font-size: 15.71px;">Docker</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/Maven/" style="font-size: 11.43px;">Maven</a> <a href="/tags/MySQL/" style="font-size: 10px;">MySQL</a> <a href="/tags/Nginx/" style="font-size: 15.71px;">Nginx</a> <a href="/tags/OpenVPN/" style="font-size: 12.86px;">OpenVPN</a> <a href="/tags/Podman/" style="font-size: 11.43px;">Podman</a> <a href="/tags/Redis/" style="font-size: 11.43px;">Redis</a> <a href="/tags/Transaction/" style="font-size: 10px;">Transaction</a> <a href="/tags/cdt/" style="font-size: 10px;">cdt</a> <a href="/tags/https/" style="font-size: 10px;">https</a> <a href="/tags/iOS/" style="font-size: 17.14px;">iOS</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/nginx-obs/" style="font-size: 10px;">nginx + obs</a> <a href="/tags/php-fpm/" style="font-size: 10px;">php-fpm</a> <a href="/tags/podman/" style="font-size: 14.29px;">podman</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/rocketmq/" style="font-size: 10px;">rocketmq</a> <a href="/tags/shiro/" style="font-size: 11.43px;">shiro</a> <a href="/tags/spring/" style="font-size: 11.43px;">spring</a> <a href="/tags/springcloud/" style="font-size: 10px;">springcloud</a> <a href="/tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="/tags/transaction/" style="font-size: 10px;">transaction</a> <a href="/tags/%E5%85%B3%E9%94%AE%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">关键笔记</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 10px;">分布式</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" style="font-size: 10px;">分布式事务</a> <a href="/tags/%E5%8E%9F%E5%88%9B/" style="font-size: 20px;">原创</a> <a href="/tags/%E5%A4%9A%E8%BF%9B%E7%A8%8B/" style="font-size: 10px;">多进程</a> <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 11.43px;">大数据</a> <a href="/tags/%E5%B9%B6%E5%8F%91/" style="font-size: 10px;">并发</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 10px;">总结</a> <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 10px;">操作系统</a> <a href="/tags/%E6%9E%B6%E6%9E%84/" style="font-size: 10px;">架构</a> <a href="/tags/%E7%94%B5%E5%95%86/" style="font-size: 10px;">电商</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">笔记</a> <a href="/tags/%E8%BD%AC%E8%BD%BD/" style="font-size: 18.57px;">转载</a> <a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 10px;">随笔</a>
					</div>
				</section>
				

				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://andylee1988.github.io">andylee1988的博客</a><br />
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://devtll.github.io">devtll的博客</a><br />
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://esnake0.github.io">esnake0的博客</a><br />
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.shaofan.org">少凡的独立博客</a><br />
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/liuguofeng719?viewmode=list">guofeng的博客</a><br />
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://witchan.com">WitChan的技术博客</a><br />
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/kelanq">kelanQ的博客</a><br />
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://chenxinyu.work">IT古书</a><br />
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://8tool.club">KnowledgeBase</a><br />
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://cherrycheng.top">cherrycheng</a><br />
			        
			        </div>
				</section>
				

				
			</div>
		</div>

	</header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">建均笔记</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="/img/avatar.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">建均笔记</h1>
			</hgroup>
			
			<p class="header-subtitle">不积跬步 无以至千里</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/about">关于我</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/stotem" title="github">github</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
						<a class="mail" target="_blank" href="mailto:china.wujianjun@icloud.com" title="mail">mail</a>
			        
				</div>
				<div style="text-align: center;">
					<i class="fa fa-line-chart"></i>
					本站访问量<span id=“busuanzi_container_site_pv”><span id="busuanzi_value_site_pv"><i class="fa fa-spinner fa-spin"></i></span></span> 次
				</div>
			</nav>
		</header>
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-distributed-redis-locked-queue" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/31/distributed-redis-locked-queue/" class="article-date">
  	<time datetime="2016-05-31T03:56:20.000Z" itemprop="datePublished">2016-05-31</time>
</a>
      <div class="analysis-container">
	<i class="fa fa-line-chart"></i>
	已阅读<span id=“busuanzi_container_page_pv”><span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span></span> 次
</div>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/31/distributed-redis-locked-queue/">Redis实现分布式锁和分布式队列</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
              
        <h2 id="分布式锁"><a href="#分布式锁" class="headerlink" title="分布式锁"></a>分布式锁</h2><p>通过Redis做分布式系统的共享内存实现方案中，可以实现分布式锁的功能。实现方法就是用 SET NX 命令设置一个设定了存活周期 TTL 的 Key 来获取锁，通过删除 Key 来释放锁，通过存活周期来保证避免死锁。<br>如：<code>SET resource_name my_random_value NX PX 30000</code></p>
<p> <em>注：</em></p>
<hr>
<p><code>SET key value [EX seconds] [PX milliseconds] [NX|XX]</code><br>从2.6.12版本开始，redis为SET命令增加了一系列选项:</p>
<ul>
<li>EX seconds – Set the specified expire time, in seconds.</li>
<li>PX milliseconds – Set the specified expire time, in milliseconds.</li>
<li>NX – Only set the key if it does not already exist.</li>
<li>XX – Only set the key if it already exist.</li>
<li>EX seconds – 设置键key的过期时间，单位时秒</li>
<li>PX milliseconds – 设置键key的过期时间，单位时毫秒</li>
<li>NX – 只有键key不存在的时候才会设置key的值</li>
<li>XX – 只有键key存在的时候才会设置key的值</li>
</ul>
<p>但，以上简单方案存在一个单点故障的风险。在master/slave环境下，当：</p>
<ol>
<li>客户端A获取到锁.</li>
<li>master节点在将 key 复制到 slave 节点之前崩溃了</li>
<li>此时，slave节点被提升为master节点.</li>
<li>客户端 B 从新的 master 节点获得了锁(而这个锁实际上已经由客户端 A 所持有)，导致了系统中有两个客户端在同一时间段内持有同一个互斥锁，破坏了互斥锁的安全性。</li>
</ol>
<p>__解决方法：__需要解决以上问题，需要在进行锁设值时将惟一标识系统的ID做为value一同存储到Redis中，在完成所有的操作后，进行解锁时取出Redis内存储的value进行比对，<br>如果锁key对应的value还是当前系统的ID,那么表示当前锁目前只被当前系统所持有，反之，则表示锁被其它的系统抢占，那么需要回滚所有的操作。</p>
<p>如：</p>
<table>
<thead>
<tr>
<th align="left">客户端A（ID为SYSA）</th>
<th align="left">Redis</th>
<th align="left">客户端B（ID为SYSB）</th>
</tr>
</thead>
<tbody><tr>
<td align="left">获取到锁（SET dist_lock SYSA NX PX 30000)</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">进行其它的业务操作。。。</td>
<td align="left">master发生故障，slave被提升为NewMaster(未将master中dist_lock复制到NewMaster)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left">获取到锁（SET dist_lock SYSB NX PX 30000）</td>
</tr>
<tr>
<td align="left">解锁 (get dist_lock，对value进行判定，为SYSA则执行解锁，否则回滚业务)</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left">解锁 (get dist_lock，对value进行判定，为SYSB则执行解锁，否则回滚业务)</td>
</tr>
</tbody></table>
<h2 id="分布式队列"><a href="#分布式队列" class="headerlink" title="分布式队列"></a>分布式队列</h2><p>Redis实现分布式队列主要实现是通过<code>有序集合</code>实现，通过ZADD向集合内添加元素，同时添加多个元素时为事务处理（不存在部分成功部分失败的情况）</p>
<p> <em>注：</em></p>
<hr>
<p><code>ZADD key [NX|XX] [CH] [INCR] score member [score member ...]</code><br>从3.0.2版本开始，增加以下选项：</p>
<ul>
<li>XX: Only update elements that already exist. Never add elements.</li>
<li>NX: Don’t update already existing elements. Always add new elements.</li>
<li>CH: Modify the return value from the number of new elements added, to the total number of elements changed (CH is an abbreviation of changed). Changed elements are new elements added and elements already existing for which the score was updated. So elements specified in the command line having the same score as they had in the past are not counted. Note: normally the return value of ZADD only counts the number of new elements added.</li>
<li>INCR: When this option is specified ZADD acts like ZINCRBY. Only one score-element pair can be specified in this mode.</li>
</ul>
<h2 id="另外的选择"><a href="#另外的选择" class="headerlink" title="另外的选择"></a>另外的选择</h2><p>_Java库：_其实也在使用<a target="_blank" rel="noopener" href="https://github.com/mrniko/redisson">redisson</a>来实现分布式锁。它封装了针对Redis各种操作的分布式实现。</p>
<p>其它语言可参照官网文章: <a target="_blank" rel="noopener" href="http://redis.io/topics/distlock?cm_mc_uid=77610277652214581184982&amp;cm_mc_sid_50200000=1464593765">http://redis.io/topics/distlock?cm_mc_uid=77610277652214581184982&amp;cm_mc_sid_50200000=1464593765</a></p>
<hr>
<p><em>观点仅代表自己，期待你的留言。</em></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-mysql-lock-transaction" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/30/mysql-lock-transaction/" class="article-date">
  	<time datetime="2016-05-30T10:00:50.000Z" itemprop="datePublished">2016-05-30</time>
</a>
      <div class="analysis-container">
	<i class="fa fa-line-chart"></i>
	已阅读<span id=“busuanzi_container_page_pv”><span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span></span> 次
</div>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/30/mysql-lock-transaction/">关于MariaDB事务阻塞等待及锁的实验笔记</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
              
        <h2 id="实验环境"><a href="#实验环境" class="headerlink" title="实验环境"></a>实验环境</h2><p>Server Version: 10.0.24-MariaDB<br>SET GLOBAL tx_isolation=’REPEATABLE-READ’;<br>SET SESSION tx_isolation=’REPEATABLE-READ’;<br>SET @@autocommit=0;</p>
<p>SHOW VARIABLES like ‘autocommit’;<br>SELECT @@GLOBAL.tx_isolation, @@tx_isolation;</p>
<h2 id="实验结论"><a href="#实验结论" class="headerlink" title="实验结论"></a>实验结论</h2><h3 id="幻读的概念是另一事务先完成的情况下判断"><a href="#幻读的概念是另一事务先完成的情况下判断" class="headerlink" title="幻读的概念是另一事务先完成的情况下判断"></a>幻读的概念是另一事务先完成的情况下判断</h3><table>
<thead>
<tr>
<th align="left">事务A</th>
<th align="left">事务B</th>
</tr>
</thead>
<tbody><tr>
<td align="left">start TRANSACTION;</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">select * from t1;(查询出2条数据)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left">start TRANSACTION;</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">insert into t1 values(null,’v222’);</td>
</tr>
<tr>
<td align="left">select * from t1;(查询出2条数据)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left">commit;(<strong>这一步很关键，它标识了事务B的完成</strong>)</td>
</tr>
<tr>
<td align="left">select * from t1;(查询出3条数据)</td>
<td align="left"></td>
</tr>
</tbody></table>
<p><code>InnoDB存储引擎在REPEATABLE-READ的隔离级别下解决了幻读情况，所以会造成以上的情况。</code></p>
<h3 id="并发事务修改同一行数据时，后执行更新的事务会-阻塞等待-先执行更新事务先结束（rollback或commit）或者超时"><a href="#并发事务修改同一行数据时，后执行更新的事务会-阻塞等待-先执行更新事务先结束（rollback或commit）或者超时" class="headerlink" title="并发事务修改同一行数据时，后执行更新的事务会__阻塞等待__先执行更新事务先结束（rollback或commit）或者超时"></a>并发事务修改同一行数据时，后执行更新的事务会__阻塞等待__先执行更新事务先结束（rollback或commit）或者超时</h3><table>
<thead>
<tr>
<th align="left">事务A</th>
<th align="left">事务B</th>
</tr>
</thead>
<tbody><tr>
<td align="left">start TRANSACTION;</td>
<td align="left">start TRANSACTION;</td>
</tr>
<tr>
<td align="left">update t1 SET da=’v1111’ where id=1;</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left">update t1 SET da=’v1111’ where id=1;(此时会等待事务A执行完成 OR 等待超时)</td>
</tr>
</tbody></table>
<h3 id="并发事务更新时只要被更新的数据存在交集，那么就会存在-阻塞等待-另一事务完成的现象"><a href="#并发事务更新时只要被更新的数据存在交集，那么就会存在-阻塞等待-另一事务完成的现象" class="headerlink" title="并发事务更新时只要被更新的数据存在交集，那么就会存在__阻塞等待__另一事务完成的现象"></a>并发事务更新时只要被更新的数据存在交集，那么就会存在__阻塞等待__另一事务完成的现象</h3><table>
<thead>
<tr>
<th align="left">事务A</th>
<th align="left">事务B</th>
</tr>
</thead>
<tbody><tr>
<td align="left">start TRANSACTION;</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">select * from t1;(查询出2条数据)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left">start TRANSACTION;</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">insert into t1 values(null,’v222’);</td>
</tr>
<tr>
<td align="left">update t1 set da=’updated’(此时会等事务B的完成)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left">commit;</td>
</tr>
</tbody></table>
<h3 id="并发事务更新时只要存在全表扫描-不管数据存在不存在交集-，那么就会存在-阻塞等待-另一事务完成的现象"><a href="#并发事务更新时只要存在全表扫描-不管数据存在不存在交集-，那么就会存在-阻塞等待-另一事务完成的现象" class="headerlink" title="并发事务更新时只要存在全表扫描(不管数据存在不存在交集)，那么就会存在__阻塞等待__另一事务完成的现象"></a>并发事务更新时只要存在全表扫描(不管数据存在不存在交集)，那么就会存在__阻塞等待__另一事务完成的现象</h3><table>
<thead>
<tr>
<th align="left">事务A</th>
<th align="left">事务B</th>
</tr>
</thead>
<tbody><tr>
<td align="left">start TRANSACTION;</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">select * from t1;(查询出2条数据)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left">start TRANSACTION;</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">update t1 SET da=’v1113333331’ where id=1</td>
</tr>
<tr>
<td align="left">update t1 set da=’updated’ where da like ‘%0000%’(此时会等事务B的完成)</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left">commit;</td>
</tr>
</tbody></table>
<hr>
<p><em>观点仅代表自己，期待你的留言。</em></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-transaction-isolation-levels" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/27/transaction-isolation-levels/" class="article-date">
  	<time datetime="2016-05-27T13:34:55.000Z" itemprop="datePublished">2016-05-27</time>
</a>
      <div class="analysis-container">
	<i class="fa fa-line-chart"></i>
	已阅读<span id=“busuanzi_container_page_pv”><span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span></span> 次
</div>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/27/transaction-isolation-levels/">数据库事务隔离级别与并发事务控制（悲观锁与乐观锁）</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
              
        <h2 id="事务特性"><a href="#事务特性" class="headerlink" title="事务特性"></a>事务特性</h2><p>事务具有4个属性：原子性、一致性、隔离性、持久性。这四个属性通常称为ACID特性。</p>
<ol>
<li>原子性（Atomicity）：事务作为一个整体被执行，包含在其中的对数据库的操作要么全部被执行，要么都不执行。</li>
<li>一致性（Consistency）：事务应确保数据库的状态从一个一致状态转变为另一个一致状态。一致状态的含义是数据库中的数据应满足完整性约束。</li>
<li>隔离性（Isolation）：多个事务并发执行时，一个事务的执行不应影响其他事务的执行。</li>
<li>持久性（Durability）：一个事务一旦提交，他对数据库的修改应该永久保存在数据库中。</li>
</ol>
<h2 id="事务的隔离级别"><a href="#事务的隔离级别" class="headerlink" title="事务的隔离级别"></a>事务的隔离级别</h2><p>由于事务的隔离性允许多个事务同时处理同一数据，所以，在多个事务并发操作的过程中，如果控制不好隔离级别，就有可能产生_脏读_、_不可重复读_或者_幻读_等现象。因此在操作数据的过程中需要合理利用数据库锁机制或者多版本并发控制机制获取更高的隔离等级，但是，随着数据库隔离级别的提高，数据的并发能力也会有所下降。所以，如何在并发性和隔离性之间做一个很好的权衡就成了一个至关重要的问题。</p>
<p>ANSI/ISO SQL定义的标准隔离级别从高到低依次为：可串行化(Serializable)、可重复读(Repeatable reads)、提交读(Read committed)、未提交读(Read uncommitted)。</p>
<table>
<thead>
<tr>
<th align="left">隔离级别</th>
<th align="left">脏读（Dirty Read）</th>
<th align="left">不可重复读（NonRepeatable Read）</th>
<th align="left">幻读（Phantom Read）</th>
</tr>
</thead>
<tbody><tr>
<td align="left">未提交读（Read uncommitted）</td>
<td align="left">可能</td>
<td align="left">可能</td>
<td align="left">可能</td>
</tr>
<tr>
<td align="left">提交读（Read committed）</td>
<td align="left">不可能</td>
<td align="left">可能</td>
<td align="left">可能</td>
</tr>
<tr>
<td align="left">可重复读（Repeatable Read）</td>
<td align="left">不可能</td>
<td align="left">不可能</td>
<td align="left">可能</td>
</tr>
<tr>
<td align="left">可串行化（Serializable）</td>
<td align="left">不可能</td>
<td align="left">不可能</td>
<td align="left">不可能</td>
</tr>
</tbody></table>
<p>===========================================================================================</p>
<ul>
<li>未提交读(Read Uncommitted)：允许脏读，也就是可能读取到其他会话中未提交事务修改的数据。</li>
<li>提交读(Read Committed)：被读取的数据可以被其他事务修改。这样就可能导致不可重复读。也就是说，事务的读取数据的时候获取读锁，但是读完之后立即释放（不需要等到事务结束），而写锁则是事务提交之后才释放。释放读锁之后，就可能被其他事物修改数据。Oracle等多数数据库默认都是该级别 (不重复读)</li>
<li>可重复读(Repeated Read)：所有被Select获取的数据都不能被修改，这样就可以避免一个事务前后读取数据不一致的情况。但是却没有办法控制幻读，因为这个时候其他事务不能更改所选的数据，但是可以增加数据，因为前一个事务没有范围锁。Mysql的InnoDB引擎默认隔离级别。</li>
<li>可串行化(Serializable)：所有事务都一个接一个地串行执行，这样可以避免幻读（phantom reads）,每次读都需要获得表级共享锁，读写相互都会阻塞。</li>
</ul>
<h2 id="数据库并发控制"><a href="#数据库并发控制" class="headerlink" title="数据库并发控制"></a>数据库并发控制</h2><p>虽然将事务串形化可以保证数据在多事务并发处理下不存在数据不一致的问题，但串行执行使得数据库的处理性能大幅度地下降，常常是你接受不了的。所以，一般来说，数据库的隔离级别都会设置为read committed（只能读取其他事务已提交的数据），然后由应用程序使用__乐观锁/悲观锁__来弥补数据不一致的问题。</p>
<h3 id="乐观锁"><a href="#乐观锁" class="headerlink" title="乐观锁"></a>乐观锁</h3><p>虽然名字中带“锁”，但是乐观锁并不锁住任何东西，而是在提交事务时检查自己上次读取这条记录后，是否有其他事务修改了这条记录，如果没有则提交，如果被修改了则回滚。如果并发的可能性并不大，那么锁定策略带来的性能消耗是非常小的。</p>
<p>常见实现方式：在数据表增加version字段，每次事务开始时将取出version字段值，而后在更新数据的同时version增加1（如：<code>update xxx set data=#&#123;data&#125;,version=version+1 where version=#&#123;version&#125;</code>），如没有数据被更新，那么说明数据由其它的事务进行了更新，此时就可以判断当前事务所操作的历史快照数据。</p>
<h3 id="悲观锁"><a href="#悲观锁" class="headerlink" title="悲观锁"></a>悲观锁</h3><p>和乐观锁相比，悲观锁则是一把真正的锁了，它通过SQL语句“select for update”锁住select出的那批数据，这时如果其他事务来更新这批数据时会等待。</p>
<p>总的来说，悲观锁相对乐观锁更安全一些，但是开销也更大，甚至可能出现数据库死锁的情况，建议只在乐观锁无法工作时才使用。</p>
<hr>
<p><em>观点仅代表自己，期待你的留言。</em></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-maven-deploy" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/26/maven-deploy/" class="article-date">
  	<time datetime="2016-05-26T08:51:51.000Z" itemprop="datePublished">2016-05-26</time>
</a>
      <div class="analysis-container">
	<i class="fa fa-line-chart"></i>
	已阅读<span id=“busuanzi_container_page_pv”><span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span></span> 次
</div>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/26/maven-deploy/">Maven应用远程部署</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
              
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>在程序开发的过程中对研发环境服务器应用部署将会非常的频繁，而通过tomcat-maven-plugin的deploy很容易实现web应用的远程发布。<br>而针对jar的发布一般会搭建maven私服，同样在研发阶段也会发布的非常频繁通过maven的deploy也非常容易实现maven私服的jar提交。</p>
<h2 id="远程发布Web应用"><a href="#远程发布Web应用" class="headerlink" title="远程发布Web应用"></a>远程发布Web应用</h2><p>以tomcat-maven-plugin为例，具体配置如下：<br><em>pom.xml</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27;?&gt;</span><br><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line">    &lt;build&gt;	</span><br><span class="line">    	&lt;plugins&gt;	</span><br><span class="line">    		&lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">                &lt;version&gt;2.2&lt;/version&gt;</span><br><span class="line">                &lt;configuration&gt;</span><br><span class="line">                    &lt;path&gt;/&lt;/path&gt;</span><br><span class="line">                    &lt;port&gt;8080&lt;/port&gt;</span><br><span class="line">                    &lt;uriEncoding&gt;UTF-8&lt;/uriEncoding&gt;</span><br><span class="line">                    &lt;server&gt;DevServer&lt;/server&gt;</span><br><span class="line">                    &lt;url&gt;http://deploy.dev.com/manager&lt;/url&gt;</span><br><span class="line">                &lt;/configuration&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line">        &lt;/plugins&gt;</span><br><span class="line">    &lt;/build&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
<p><strong>说明:</strong><br>server: 为settings.xml中配置的server节点ID，用于上传鉴权。<br>url：发布到的服务器的tomcat/manager工程访问地址。</p>
<p><em>settings.xml</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27;?&gt;</span><br><span class="line">&lt;settings xsi:schemaLocation=&quot;http://maven.apache.org/SETTINGS/1.1.0 http://maven.apache.org/xsd/settings-1.1.0.xsd&quot; xmlns=&quot;http://maven.apache.org/SETTINGS/1.1.0&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;</span><br><span class="line">    &lt;servers&gt;</span><br><span class="line">	    &lt;server&gt;</span><br><span class="line">	    	&lt;id&gt;DevServer&lt;/id&gt;</span><br><span class="line">	      	&lt;username&gt;abc&lt;/username&gt;</span><br><span class="line">	        &lt;password&gt;xxx&lt;/password&gt;</span><br><span class="line">	    &lt;/server&gt;</span><br><span class="line">    &lt;/servers&gt;</span><br><span class="line">&lt;/settings&gt;</span><br></pre></td></tr></table></figure>
<p><em>tomcat-users.xml</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27;?&gt;</span><br><span class="line">&lt;tomcat-users&gt;</span><br><span class="line">&lt;role rolename=&quot;manager-gui&quot; /&gt;</span><br><span class="line">&lt;role rolename=&quot;manager-script&quot; /&gt;</span><br><span class="line">&lt;user username=&quot;abc&quot; password=&quot;xxx&quot; roles=&quot;manager-gui,manager-script&quot;/&gt;</span><br><span class="line">&lt;/tomcat-users&gt;</span><br></pre></td></tr></table></figure>

<p>–[更新] 发现更简便配置,详细如下：—<br>将maven的pom.xml中将server节点直接替换成username与password节点，这样就不需要在setting.xml中进行配置了。<br><em>pom.xml</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27;?&gt;</span><br><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line">    &lt;build&gt; </span><br><span class="line">      &lt;plugins&gt; </span><br><span class="line">        &lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">                &lt;version&gt;2.2&lt;/version&gt;</span><br><span class="line">                &lt;configuration&gt;</span><br><span class="line">                    &lt;path&gt;/&lt;/path&gt;</span><br><span class="line">                    &lt;port&gt;8080&lt;/port&gt;</span><br><span class="line">                    &lt;uriEncoding&gt;UTF-8&lt;/uriEncoding&gt;</span><br><span class="line">                    &lt;username&gt;abc&lt;/username&gt;</span><br><span class="line">                    &lt;password&gt;xxx&lt;/password&gt;</span><br><span class="line">                    &lt;url&gt;http://deploy.dev.com/manager&lt;/url&gt;</span><br><span class="line">                &lt;/configuration&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line">        &lt;/plugins&gt;</span><br><span class="line">    &lt;/build&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>

<h2 id="远程发布依赖库jar"><a href="#远程发布依赖库jar" class="headerlink" title="远程发布依赖库jar"></a>远程发布依赖库jar</h2><p><em>pom.xml</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27;?&gt;</span><br><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line">    &lt;distributionManagement&gt;</span><br><span class="line">        &lt;snapshotRepository&gt;</span><br><span class="line">            &lt;id&gt;snapshots&lt;/id&gt;</span><br><span class="line">            &lt;name&gt;libs-snapshot&lt;/name&gt;</span><br><span class="line">            &lt;url&gt;http://mvn.code.com/artifactory/libs-snapshot-local&lt;/url&gt;</span><br><span class="line">        &lt;/snapshotRepository&gt;</span><br><span class="line">    &lt;/distributionManagement&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
<p><strong>说明:</strong><br>id: 表示配置的用户名和密码，这个ID在settings.xml里配置<br>url: 为私服上传地址。</p>
<p><em>settings.xml</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27;?&gt;</span><br><span class="line">&lt;settings xsi:schemaLocation=&quot;http://maven.apache.org/SETTINGS/1.1.0 http://maven.apache.org/xsd/settings-1.1.0.xsd&quot; xmlns=&quot;http://maven.apache.org/SETTINGS/1.1.0&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;</span><br><span class="line">    &lt;servers&gt;</span><br><span class="line">	    &lt;server&gt;</span><br><span class="line">	    	&lt;id&gt;snapshots&lt;/id&gt;</span><br><span class="line">	      	&lt;username&gt;abc&lt;/username&gt;</span><br><span class="line">	        &lt;password&gt;xxx&lt;/password&gt;</span><br><span class="line">	    &lt;/server&gt;</span><br><span class="line">    &lt;/servers&gt;</span><br><span class="line">&lt;/settings&gt;</span><br></pre></td></tr></table></figure>

<p>配置完成之后执行<code>maven deploy</code>就OK啦。</p>
<hr>
<p><em>观点仅代表自己，期待你的留言。</em></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Maven/" rel="tag">Maven</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-maven-profile" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/26/maven-profile/" class="article-date">
  	<time datetime="2016-05-26T08:15:01.000Z" itemprop="datePublished">2016-05-26</time>
</a>
      <div class="analysis-container">
	<i class="fa fa-line-chart"></i>
	已阅读<span id=“busuanzi_container_page_pv”><span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span></span> 次
</div>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/26/maven-profile/">Maven应用发布之不同环境不同配置的实现</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
              
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>一个应用程序从研发到发布一般需要经过三套环境（研发环境、测试环境、生产环境）甚至更多。针对这同的运行环境应用程序也需要一些不同的参数配置值（如果日志输出级别、数据库连接池配置等）。<br>Maven的Profile配置很好的解决这一问题。在pom.xml中配置多套参数值，在程序打包__编译时期__通过部署环境对配置参数进行替换来完成。<br>__注意:__当配置项找不到对应的配置值时会保持原样。</p>
<h2 id="pom-xml多套参数配置"><a href="#pom-xml多套参数配置" class="headerlink" title="pom.xml多套参数配置"></a>pom.xml多套参数配置</h2><p>以不同部署环境配置日志输出级别为例。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;</span><br><span class="line">    &lt;properties&gt;</span><br><span class="line">    	&lt;catalina.base&gt;/app/servers/logs&lt;/catalina.base&gt;</span><br><span class="line">    &lt;/properties&gt;</span><br><span class="line">    &lt;profiles&gt;</span><br><span class="line">    	&lt;profile&gt;</span><br><span class="line">            &lt;id&gt;dev&lt;/id&gt;</span><br><span class="line">            &lt;activation&gt;</span><br><span class="line">                &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;</span><br><span class="line">            &lt;/activation&gt;</span><br><span class="line">            &lt;properties&gt;</span><br><span class="line">                &lt;catalina.log.priority&gt;debug&lt;/catalina.log.priority&gt;</span><br><span class="line">            &lt;/properties&gt;</span><br><span class="line">        &lt;/profile&gt;</span><br><span class="line">        &lt;profile&gt;</span><br><span class="line">            &lt;id&gt;test&lt;/id&gt;</span><br><span class="line">            &lt;properties&gt;</span><br><span class="line">                &lt;catalina.log.priority&gt;warn&lt;/catalina.log.priority&gt;</span><br><span class="line">            &lt;/properties&gt;</span><br><span class="line">        &lt;/profile&gt;</span><br><span class="line">    	&lt;profile&gt;</span><br><span class="line">            &lt;id&gt;pro&lt;/id&gt;</span><br><span class="line">            &lt;properties&gt;</span><br><span class="line">                &lt;catalina.log.priority&gt;error&lt;/catalina.log.priority&gt;</span><br><span class="line">            &lt;/properties&gt;</span><br><span class="line">        &lt;/profile&gt;</span><br><span class="line">    &lt;/profiles&gt;</span><br><span class="line">    &lt;build&gt;</span><br><span class="line">    	&lt;resources&gt;</span><br><span class="line">            &lt;resource&gt;</span><br><span class="line">                &lt;directory&gt;src/main/resources&lt;/directory&gt;</span><br><span class="line">                &lt;filtering&gt;true&lt;/filtering&gt;</span><br><span class="line">            &lt;/resource&gt;</span><br><span class="line">        &lt;/resources&gt;</span><br><span class="line">    &lt;/build&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
<p><strong>说明：</strong><br>以上配置表示在编译时期对<code>src/main/resources</code>目录下配置文件中的<code>$&#123;catalina.log.priority&#125;</code>和<code>$&#123;catalina.base&#125;</code>进行替换。而catalina.base参数值不区分部署环境。<br>编译开发环境的部署程序包命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Jianjun:~ Jianjun$ mvn package –P dev</span><br></pre></td></tr></table></figure>
<p>编译测试环境的部署程序包命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Jianjun:~ Jianjun$ mvn package –P test</span><br></pre></td></tr></table></figure>
<p>编译生产环境的部署程序包命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Jianjun:~ Jianjun$ mvn package –P pro</span><br></pre></td></tr></table></figure>
<p>如果不指-P参数，默认会使用dev的配置，由于dev节点配置了__activeByDefault__</p>
<h2 id="参数配置项太多"><a href="#参数配置项太多" class="headerlink" title="参数配置项太多"></a>参数配置项太多</h2><p>当配置项太多之后我们可以通过外置properties文件来进行配置，而properties文件需要与pom.xml在同一路径下。<br>properties配置如下：<br><em>product-deploy-config-dev.properties</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">catalina.log.priority=debug</span><br></pre></td></tr></table></figure>
<p><em>product-deploy-config-test.properties</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">catalina.log.priority=warn</span><br></pre></td></tr></table></figure>
<p><em>product-deploy-config-pro.properties</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">catalina.log.priority=error</span><br></pre></td></tr></table></figure>
<p>pom.xml配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;</span><br><span class="line">    &lt;properties&gt;</span><br><span class="line">    	&lt;catalina.base&gt;/app/servers/logs&lt;/catalina.base&gt;</span><br><span class="line">    &lt;/properties&gt;</span><br><span class="line">    &lt;profiles&gt;</span><br><span class="line">    	&lt;profile&gt;</span><br><span class="line">            &lt;id&gt;dev&lt;/id&gt;</span><br><span class="line">            &lt;activation&gt;</span><br><span class="line">                &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;</span><br><span class="line">            &lt;/activation&gt;</span><br><span class="line">            &lt;build&gt;</span><br><span class="line">            	&lt;filters&gt;</span><br><span class="line">            		&lt;filter&gt;product-deploy-config-dev.properties&lt;/filter&gt;</span><br><span class="line">				&lt;/filters&gt;</span><br><span class="line">            &lt;/build&gt;</span><br><span class="line">        &lt;/profile&gt;</span><br><span class="line">        &lt;profile&gt;</span><br><span class="line">            &lt;id&gt;test&lt;/id&gt;</span><br><span class="line">            &lt;build&gt;</span><br><span class="line">            	&lt;filters&gt;</span><br><span class="line">					&lt;filter&gt;product-deploy-config-test.properties&lt;/filter&gt;</span><br><span class="line">				&lt;/filters&gt;</span><br><span class="line">            &lt;/build&gt;</span><br><span class="line">        &lt;/profile&gt;</span><br><span class="line">    	&lt;profile&gt;</span><br><span class="line">            &lt;id&gt;pro&lt;/id&gt;</span><br><span class="line">            &lt;build&gt;</span><br><span class="line">            	&lt;filters&gt;</span><br><span class="line">					&lt;filter&gt;product-deploy-config-pro.properties&lt;/filter&gt;</span><br><span class="line">				&lt;/filters&gt;</span><br><span class="line">            &lt;/build&gt;</span><br><span class="line">        &lt;/profile&gt;</span><br><span class="line">    &lt;/profiles&gt;</span><br><span class="line">    &lt;build&gt;</span><br><span class="line">    	&lt;resources&gt;</span><br><span class="line">            &lt;resource&gt;</span><br><span class="line">                &lt;directory&gt;src/main/resources&lt;/directory&gt;</span><br><span class="line">                &lt;filtering&gt;true&lt;/filtering&gt;</span><br><span class="line">            &lt;/resource&gt;</span><br><span class="line">        &lt;/resources&gt;</span><br><span class="line">    &lt;/build&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>

<hr>
<p><em>观点仅代表自己，期待你的留言。</em></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Maven/" rel="tag">Maven</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-os-port-forward" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/26/os-port-forward/" class="article-date">
  	<time datetime="2016-05-26T03:07:35.000Z" itemprop="datePublished">2016-05-26</time>
</a>
      <div class="analysis-container">
	<i class="fa fa-line-chart"></i>
	已阅读<span id=“busuanzi_container_page_pv”><span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span></span> 次
</div>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/26/os-port-forward/">使用端口转发解决80端口使用问题</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
              
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>当我用在使用linux非root用户进行应用发布时，如遇到应用程序需要占用80端口时总会由于权限不足遇到<code>java.net.BindException: Permission denied:80</code>的错误报出。<br>Linux为保证系统安全，限制了非root用户对1024以下的端口进行占用。<br>那么，本文将通过端口转发的方式解决80端口在Linux和MacOSX系统上占用的问题。</p>
<h2 id="linux非Root用户使用80端口"><a href="#linux非Root用户使用80端口" class="headerlink" title="linux非Root用户使用80端口"></a>linux非Root用户使用80端口</h2><p>linux操作系统的可以通过iptables来进行端口转发，将流向80端口的数据内部转发到大于1024的端口上。那么非root用户就可以通过占用大于1024的端口进行程序应用的功能处理。<br>以80转发到8080端口为例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# sudo iptables -t nat -A PREROUTING -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 8080</span><br><span class="line">[root@localhost ~]# sudo iptables -t nat -A OUTPUT -d localhost -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 8080</span><br><span class="line">[root@localhost ~]# iptables -t filter -F</span><br><span class="line">[root@localhost ~]# iptables-save</span><br><span class="line">[root@localhost ~]# service iptables restart</span><br><span class="line">[root@localhost ~]# chkconfig iptables on </span><br></pre></td></tr></table></figure>
<p>iptables -t filter -F : 为清除所有的过滤规则。<br>chkconfig iptables on : 设置iptables开机启动。</p>
<p>iptables存储文件：/etc/sysconfig/iptables</p>
<h2 id="MacOSX使用80端口"><a href="#MacOSX使用80端口" class="headerlink" title="MacOSX使用80端口"></a>MacOSX使用80端口</h2><p>MacOS操作系统下则使用<code>pf</code>来进行端口转发。<br>pf启动时会自动装载/etc/pf.conf文件，因此，我们可以通过修改这个文件进行80端口数据的转发。<br>修改后的文件内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">scrub-anchor &quot;com.apple/*&quot;</span><br><span class="line">nat-anchor &quot;com.apple/*&quot;</span><br><span class="line">rdr-anchor &quot;com.apple/*&quot;</span><br><span class="line">rdr on lo0 inet proto tcp from any to 127.0.0.1 port 80 -&gt; 127.0.0.1 port 8080</span><br><span class="line">dummynet-anchor &quot;com.apple/*&quot;</span><br><span class="line">anchor &quot;com.apple/*&quot;</span><br><span class="line">load anchor &quot;com.apple&quot; from &quot;/etc/pf.anchors/com.apple&quot;</span><br></pre></td></tr></table></figure>
<p>使用 pfctl使用重新加载pf.conf配置，并启动pf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Jianjun:~ Jianjun$ sudo pfctl -f /etc/pf.conf</span><br><span class="line">Jianjun:~ Jianjun$ sudo pfctl -e</span><br></pre></td></tr></table></figure>
<p>另，关闭pf的命令为：<code>sudo pfctl -d</code></p>
<hr>
<p><em>观点仅代表自己，期待你的留言。</em></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" rel="tag">操作系统</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-docker-dockerfile" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/19/docker-dockerfile/" class="article-date">
  	<time datetime="2016-04-19T02:30:45.000Z" itemprop="datePublished">2016-04-19</time>
</a>
      <div class="analysis-container">
	<i class="fa fa-line-chart"></i>
	已阅读<span id=“busuanzi_container_page_pv”><span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span></span> 次
</div>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/19/docker-dockerfile/">docker-dockerfile</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
              
        <h1 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h1><p>Dockerfile 由一行行字母大写的指令语句组成，并且支持以 <code>#</code> 开头的注释行。<br>一般的，Dockerfile 分为四部分：基础镜像信息、维护者信息、镜像操作指令和容器启动时执行指令。</p>
<h1 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h1><p>指令的一般格式为 <code>INSTRUCTION arguments</code>，指令包括 FROM、MAINTAINER、RUN 等。</p>
<h2 id="FROM"><a href="#FROM" class="headerlink" title="FROM"></a>FROM</h2><p>格式为 <code>FROM &lt;image&gt;</code>或<code>FROM &lt;image&gt;:&lt;tag&gt;</code>。<br>第一条指令必须为 FROM 指令。并且，如果在同一个Dockerfile中创建多个镜像时，可以使用多个 <code>FROM</code> 指令（每个镜像一次）。</p>
<h2 id="MAINTAINER"><a href="#MAINTAINER" class="headerlink" title="MAINTAINER"></a>MAINTAINER</h2><p>格式为 <code>MAINTAINER &lt;name&gt;</code>，指定维护者信息。</p>
<h2 id="RUN"><a href="#RUN" class="headerlink" title="RUN"></a>RUN</h2><p>格式为 <code>RUN &lt;command&gt;</code> 或 <code>RUN [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;]</code>。<br>前者将在 shell 终端中运行命令，即 <code>/bin/sh -c</code>；后者则使用 <code>exec</code> 执行。指定使用其它终端可以通过第二种方式实现，例如 <code>RUN [&quot;/bin/bash&quot;, &quot;-c&quot;, &quot;echo hello&quot;]</code>。<br>每条 <code>RUN</code> 指令将在当前镜像基础上执行指定命令，并提交为新的镜像。当命令较长时可以使用 <code>\</code> 来换行。</p>
<h2 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h2><p>支持三种格式</p>
<ul>
<li>CMD [“executable”,”param1”,”param2”] 使用 exec 执行，推荐方式；</li>
<li>CMD command param1 param2 在 /bin/sh 中执行，提供给需要交互的应用；</li>
<li>CMD [“param1”,”param2”] 提供给 ENTRYPOINT 的默认参数；<br>指定启动容器时执行的命令，__每个 Dockerfile 只能有一条 <code>CMD</code> 命令__。如果指定了多条命令，只有最后一条会被执行。<br>如果用户启动容器时候指定了运行的命令，则会覆盖掉 CMD 指定的命令。<h2 id="EXPOSE"><a href="#EXPOSE" class="headerlink" title="EXPOSE"></a>EXPOSE</h2></li>
</ul>
<p>格式为 <code>EXPOSE &lt;port&gt; [&lt;port&gt;...]</code>。<br>告诉 Docker 服务端容器暴露的端口号，供互联系统使用。在启动容器时需要通过 <code>-P</code>，Docker 主机会自动分配一个端口转发到指定的端口。</p>
<h2 id="ENV"><a href="#ENV" class="headerlink" title="ENV"></a>ENV</h2><p>格式为 <code>ENV &lt;key&gt; &lt;value&gt;</code>。 指定一个环境变量，会被后续 <code>RUN</code> 指令使用，并在容器运行时保持。<br>例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ENV PG_MAJOR 9.3</span><br><span class="line">ENV PG_VERSION 9.3.4</span><br><span class="line">RUN curl -SL http://example.com/postgres-$PG_VERSION.tar.xz | tar -xJC /usr/src/postgress &amp;&amp; …</span><br><span class="line">ENV PATH /usr/local/postgres-$PG_MAJOR/bin:$PATH</span><br></pre></td></tr></table></figure>
<h2 id="ADD"><a href="#ADD" class="headerlink" title="ADD"></a>ADD</h2><p>格式为 <code>ADD &lt;src&gt; &lt;dest&gt;</code>。<br>该命令将复制指定的 <code>&lt;src&gt;</code> 到容器中的 <code>&lt;dest&gt;</code>。 其中 <code>&lt;src&gt;</code> 可以是Dockerfile所在目录的一个相对路径；也可以是一个 URL；还可以是一个 tar 文件（自动解压为目录）。</p>
<h2 id="COPY"><a href="#COPY" class="headerlink" title="COPY"></a>COPY</h2><p>格式为 <code>COPY &lt;src&gt; &lt;dest&gt;</code>。<br>复制本地主机的 <code>&lt;src&gt;</code>（为 Dockerfile 所在目录的相对路径）到容器中的 <code>&lt;dest&gt;</code>。<br>当使用本地目录为源目录时，推荐使用 <code>COPY</code>。</p>
<h2 id="ENTRYPOINT"><a href="#ENTRYPOINT" class="headerlink" title="ENTRYPOINT"></a>ENTRYPOINT</h2><p>两种格式：</p>
<ul>
<li>ENTRYPOINT [“executable”, “param1”, “param2”]</li>
<li>ENTRYPOINT command param1 param2（shell中执行）。<br>配置容器启动后执行的命令，并且不可被 <code>docker run</code> 提供的参数覆盖。<br>每个 Dockerfile 中只能有一个 <code>ENTRYPOINT</code>，__当指定多个时，只有最后一个起效__。<h2 id="VOLUME"><a href="#VOLUME" class="headerlink" title="VOLUME"></a>VOLUME</h2></li>
</ul>
<p>格式为 <code>VOLUME [&quot;/data&quot;]</code>。<br>创建一个可以从本地主机或其他容器挂载的挂载点，一般用来存放数据库和需要保持的数据等。</p>
<h2 id="USER"><a href="#USER" class="headerlink" title="USER"></a>USER</h2><p>格式为 <code>USER daemon</code>。<br>指定运行容器时的用户名或 UID，后续的 <code>RUN</code> 也会使用指定用户。<br>当服务不需要管理员权限时，可以通过该命令指定运行用户。并且可以在之前创建所需要的用户，例如：<code>RUN groupadd -r postgres &amp;&amp; useradd -r -g postgres postgres</code>。要临时获取管理员权限可以使用 <code>gosu</code>，而不推荐 <code>sudo</code>。</p>
<h2 id="WORKDIR"><a href="#WORKDIR" class="headerlink" title="WORKDIR"></a>WORKDIR</h2><p>格式为 <code>WORKDIR /path/to/workdir</code>。<br>为后续的 <code>RUN、CMD、ENTRYPOINT</code> 指令配置工作目录。<br>可以使用多个 <code>WORKDIR</code> 指令，后续命令如果参数是相对路径，则会基于之前命令指定的路径。<br>例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">WORKDIR /a</span><br><span class="line">WORKDIR b</span><br><span class="line">WORKDIR c</span><br><span class="line">RUN pwd</span><br></pre></td></tr></table></figure>
<p>则最终路径为 <code>/a/b/c</code>。</p>
<h2 id="ONBUILD"><a href="#ONBUILD" class="headerlink" title="ONBUILD"></a>ONBUILD</h2><p>格式为 <code>ONBUILD [INSTRUCTION]</code>。<br>配置当所创建的镜像作为其它新创建镜像的基础镜像时，所执行的操作指令。<br>例如，Dockerfile 使用如下的内容创建了镜像 <code>image-A</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[...]</span><br><span class="line">ONBUILD ADD . /app/src</span><br><span class="line">ONBUILD RUN /usr/local/bin/python-build --dir /app/src</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
<p>如果基于 <code>image-A</code> 创建新的镜像时，新的Dockerfile中使用 <code>FROM image-A</code>指定基础镜像时，会自动执行 <code>ONBUILD</code> 指令内容，等价于在后面添加了两条指令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FROM image-A</span><br><span class="line"></span><br><span class="line">#Automatically run the following</span><br><span class="line">ADD . /app/src</span><br><span class="line">RUN /usr/local/bin/python-build --dir /app/src</span><br></pre></td></tr></table></figure>
<p>使用 <code>ONBUILD</code> 指令的镜像，推荐在标签中注明，例如 <code>ruby:1.9-onbuild</code>。</p>
<h1 id="创建镜像"><a href="#创建镜像" class="headerlink" title="创建镜像"></a>创建镜像</h1><p>编写完成 Dockerfile 之后，可以通过 <code>docker build</code> 命令来创建镜像。<br>基本的格式为 <code>docker build [选项]</code> 路径，该命令将读取指定路径下（包括子目录）的 Dockerfile，并将该路径下所有内容发送给 Docker 服务端，由服务端来创建镜像。因此一般建议放置 Dockerfile 的目录为空目录。也可以通过 <code>.dockerignore</code>文件（每一行添加一条匹配模式）来让 Docker 忽略路径下的目录和文件。<br>要指定镜像的标签信息，可以通过 <code>-t</code> 选项，<br>例如:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker build -t myrepo/myapp /tmp/test1/</span><br></pre></td></tr></table></figure>

<hr>
<p><a target="_blank" rel="noopener" href="https://yeasy.gitbooks.io/docker_practice/content/dockerfile/index.html">https://yeasy.gitbooks.io/docker_practice/content/dockerfile/index.html</a></p>
<p><em>观点仅代表自己，期待你的留言。</em></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%BD%AC%E8%BD%BD/" rel="tag">转载</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-docker-data-network" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/18/docker-data-network/" class="article-date">
  	<time datetime="2016-04-18T03:33:08.000Z" itemprop="datePublished">2016-04-18</time>
</a>
      <div class="analysis-container">
	<i class="fa fa-line-chart"></i>
	已阅读<span id=“busuanzi_container_page_pv”><span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span></span> 次
</div>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/18/docker-data-network/">docker数据卷与网络配置</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
              
        <h1 id="数据卷"><a href="#数据卷" class="headerlink" title="数据卷"></a>数据卷</h1><p>Docker 挂载数据卷的默认权限是读写，用户也可以通过 :ro 指定为只读。<br>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -d -P --name web -v /src/webapp:/opt/webapp:ro training/webapp python app.py</span><br></pre></td></tr></table></figure>
<h2 id="创建数据卷"><a href="#创建数据卷" class="headerlink" title="创建数据卷"></a>创建数据卷</h2><p>在用 <code>docker run</code> 命令的时候，使用 <code>-v</code> 标记来创建一个数据卷并挂载到容器里。在一次 run 中多次使用可以挂载多个数据卷。<br>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -d -P --name web -v /webapp training/webapp python app.py</span><br></pre></td></tr></table></figure>
<h2 id="挂载一个主机目录作为数据卷"><a href="#挂载一个主机目录作为数据卷" class="headerlink" title="挂载一个主机目录作为数据卷"></a>挂载一个主机目录作为数据卷</h2><p>加载主机的 /src/webapp 目录到容器的 /opt/webapp 目录.<br>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -d -P --name web -v /src/webapp:/opt/webapp training/webapp python app.py</span><br></pre></td></tr></table></figure>
<p><code>注意：</code>本地目录的路径必须是绝对路径，如果目录不存在 Docker 会自动为你创建它。</p>
<h2 id="挂载一个本地主机文件作为数据卷"><a href="#挂载一个本地主机文件作为数据卷" class="headerlink" title="挂载一个本地主机文件作为数据卷"></a>挂载一个本地主机文件作为数据卷</h2><p>-v 标记也可以从主机挂载单个文件到容器中<br>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run --rm -it -v ~/.bash_history:/.bash_history ubuntu /bin/bash</span><br></pre></td></tr></table></figure>
<h2 id="删除数据卷"><a href="#删除数据卷" class="headerlink" title="删除数据卷"></a>删除数据卷</h2><p>数据卷是被设计用来持久化数据的，它的生命周期独立于容器，Docker不会在容器被删除后自动删除数据卷，并且也不存在垃圾回收这样的机制来处理没有任何容器引用的数据卷。如果需要在删除容器的同时移除数据卷。可以在删除容器的时候使用 <code>docker rm -v</code>这个命令。无主的数据卷可能会占据很多空间，要清理会很麻烦。</p>
<h2 id="数据卷容器"><a href="#数据卷容器" class="headerlink" title="数据卷容器"></a>数据卷容器</h2><p>如果你有一些持续更新的数据需要在容器之间共享，最好创建数据卷容器。<br>数据卷容器，其实就是一个正常的容器，专门用来提供数据卷供其它容器挂载的。<br>首先，创建一个名为 dbdata 的数据卷容器：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -d -v /dbdatas --name dbdata training/postgres echo Data-only container for postgres</span><br></pre></td></tr></table></figure>
<p>然后，在其他容器中使用 <code>--volumes-from</code> 来挂载 dbdata 容器中的数据卷。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -d --volumes-from dbdata --name db1 training/postgres</span><br><span class="line">$ sudo docker run -d --volumes-from dbdata --name db2 training/postgres</span><br></pre></td></tr></table></figure>
<p>可以使用超过一个的 –volumes-from 参数来指定从多个容器挂载不同的数据卷。 也可以从其他已经挂载了数据卷的容器来级联挂载数据卷。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -d --name db3 --volumes-from db1 training/postgres</span><br></pre></td></tr></table></figure>
<p>*注意：使用 <code>--volumes-from</code> 参数所挂载数据卷的容器自己并不需要保持在运行状态。<br>如果删除了挂载的容器（包括 dbdata、db1 和 db2），数据卷并不会被自动删除。如果要删除一个数据卷，必须在删除最后一个还挂载着它的容器时使用 <code>docker rm -v</code> 命令来指定同时删除关联的容器。</p>
<h2 id="利用数据卷容器来备份、恢复、迁移数据卷"><a href="#利用数据卷容器来备份、恢复、迁移数据卷" class="headerlink" title="利用数据卷容器来备份、恢复、迁移数据卷"></a>利用数据卷容器来备份、恢复、迁移数据卷</h2><h3 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h3><p>首先使用 –volumes-from 标记来创建一个加载 dbdata 容器卷的容器，并从主机挂载当前目录到容器的 /backup 目录。<br>命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run --volumes-from dbdata -v $(pwd):/backup ubuntu tar cvf /backup/backup.tar /dbdata</span><br></pre></td></tr></table></figure>
<p>容器启动后，使用了 tar 命令来将 dbdata 卷备份为容器中 /backup/backup.tar 文件，也就是主机当前目录下的名为 backup.tar 的文件。</p>
<h3 id="恢复"><a href="#恢复" class="headerlink" title="恢复"></a>恢复</h3><p>如果要恢复数据到一个容器，首先创建一个带有空数据卷的容器 dbdata2。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -v /dbdata --name dbdata2 ubuntu /bin/bash</span><br></pre></td></tr></table></figure>
<p>然后创建另一个容器，挂载 dbdata2 容器卷中的数据卷，并使用 untar 解压备份文件到挂载的容器卷中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run --volumes-from dbdata2 -v $(pwd):/backup busybox tar xvf /backup/backup.tar</span><br></pre></td></tr></table></figure>
<p>为了查看/验证恢复的数据，可以再启动一个容器挂载同样的容器卷来查看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run --volumes-from dbdata2 busybox /bin/ls /dbdata</span><br></pre></td></tr></table></figure>
<h1 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h1><h2 id="外部访问容器"><a href="#外部访问容器" class="headerlink" title="外部访问容器"></a>外部访问容器</h2><p>docker容器一般使用5000做为服务端口（类似于80端口的概念）。</p>
<ul>
<li>docker支持在<code>docker run</code>时增加<code>-P</code>来将主机随机端口(49000~49900)映射到容器内的5000。可通过<code>docker ps</code>查看到对应的占用端口。</li>
<li>docker支持在<code>docker run</code>时增加<code>-p</code>来将指定的主机端口映射到容器内的指定端口。<br>  支持以下格式：<ul>
<li><code>ip:hostPort:containerPort</code>： 将主机指定IP下的指定端口绑定到容器内的指定端口。</li>
<li><code>ip::containerPort</code>：绑定主机指定IP下的任意端口到容器的指定端口，本地主机会自动分配一个端口。还可以使用 udp 标记来指定 udp 端口。如<code>$ sudo docker run -d -p 127.0.0.1:5000:5000/udp training/webapp python app.py</code></li>
<li><code>hostPort:containerPort</code>：指定主机所有IP下的指定端口到容器内的指定端口。</li>
</ul>
</li>
</ul>
<p>使用 <code>docker port</code> 来查看当前映射的端口配置，<br><strong>注意：</strong></p>
<ul>
<li>容器有自己的内部网络和 ip 地址（使用 docker inspect 可以获取所有的变量，Docker 还可以有一个可变的网络配置。）</li>
<li>-p 参数可以多次使用。如：<code>$ sudo docker run -d -p 5000:5000  -p 3000:80 training/webapp python app.py</code><h2 id="容器互联"><a href="#容器互联" class="headerlink" title="容器互联"></a>容器互联</h2>连接系统依据容器的名称来执行。因此，首先需要通过<code>--name</code>自定义一个好记的容器命名。使用 <code>docker ps</code> 来验证设定的命名。</li>
</ul>
<p>使用 <code>--link</code> 参数可以让容器之间安全的进行交互。参数的格式为 <code>--link name:alias</code>，其中 name 是要链接的容器的名称，alias 是这个连接的别名。<br>将web容器与db容器连接，且连接被命名为db, 启动命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -d -P --name web --link db:db training/webapp python app.py</span><br></pre></td></tr></table></figure>

<p><strong>实现原理：</strong><br>Docker 通过 2 种方式为容器公开连接信息：</p>
<ul>
<li>环境变量。 通过linux命令<code>env</code>可以看到，环境变量通过增加alias做为前缀标识来区别容器的环境变量与连接。</li>
<li>更新 /etc/hosts 文件。在hosts文件中增加alias条目的映射ip。</li>
</ul>
<hr>
<p><em>观点仅代表自己，期待你的留言。</em></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-docker-cmd-summarize" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/15/docker-cmd-summarize/" class="article-date">
  	<time datetime="2016-04-15T02:54:54.000Z" itemprop="datePublished">2016-04-15</time>
</a>
      <div class="analysis-container">
	<i class="fa fa-line-chart"></i>
	已阅读<span id=“busuanzi_container_page_pv”><span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span></span> 次
</div>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/15/docker-cmd-summarize/">docker常用命令总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
              
        <h3 id="docker-pull"><a href="#docker-pull" class="headerlink" title="docker pull"></a>docker pull</h3><p><code>说明：</code>获取网络镜像到本地<br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> [root@localhost ~]# docker pull --help</span><br><span class="line"></span><br><span class="line">Usage:	docker pull [OPTIONS] NAME[:TAG|@DIGEST]</span><br><span class="line"></span><br><span class="line">Pull an image or a repository from a registry</span><br><span class="line"></span><br><span class="line">  -a, --all-tags                  Download all tagged images in the repository</span><br><span class="line">  --disable-content-trust=true    Skip image verification</span><br><span class="line">  --help                          Print usage</span><br></pre></td></tr></table></figure><br>当不指定TAG时，默认为：latest<br>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# sudo docker pull ubuntu:12.04</span><br><span class="line">[root@localhost ~]# docker pull registry.hub.docker.com/ubuntu:12.04</span><br></pre></td></tr></table></figure>
<h3 id="docker-images"><a href="#docker-images" class="headerlink" title="docker images"></a>docker images</h3><p><code>说明：</code>显示本地已有的镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker images --help</span><br><span class="line"></span><br><span class="line">Usage:	docker images [OPTIONS] [REPOSITORY[:TAG]]</span><br><span class="line"></span><br><span class="line">List images</span><br><span class="line"></span><br><span class="line">  -a, --all          Show all images (default hides intermediate images)</span><br><span class="line">  --digests          Show digests</span><br><span class="line">  -f, --filter=[]    Filter output based on conditions provided</span><br><span class="line">  --format           Pretty-print images using a Go template</span><br><span class="line">  --help             Print usage</span><br><span class="line">  --no-trunc         Don&#x27;t truncate output</span><br><span class="line">  -q, --quiet        Only show numeric IDs</span><br></pre></td></tr></table></figure>
<p>镜像的 <code>ID</code> 唯一标识了镜像。</p>
<h3 id="docker-run"><a href="#docker-run" class="headerlink" title="docker run"></a>docker run</h3><p><code>说明：</code>使用已下载到本地的镜像启动一个新容器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker run --help</span><br><span class="line"></span><br><span class="line">Usage:	docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br><span class="line"></span><br><span class="line">Run a command in a new container</span><br><span class="line"></span><br><span class="line">  -a, --attach=[]                 Attach to STDIN, STDOUT or STDERR</span><br><span class="line">  --add-host=[]                   Add a custom host-to-IP mapping (host:ip)</span><br><span class="line">  --blkio-weight                  Block IO (relative weight), between 10 and 1000</span><br><span class="line">  --blkio-weight-device=[]        Block IO weight (relative device weight)</span><br><span class="line">  --cpu-shares                    CPU shares (relative weight)</span><br><span class="line">  --cap-add=[]                    Add Linux capabilities</span><br><span class="line">  --cap-drop=[]                   Drop Linux capabilities</span><br><span class="line">  --cgroup-parent                 Optional parent cgroup for the container</span><br><span class="line">  --cidfile                       Write the container ID to the file</span><br><span class="line">  --cpu-period                    Limit CPU CFS (Completely Fair Scheduler) period</span><br><span class="line">  --cpu-quota                     Limit CPU CFS (Completely Fair Scheduler) quota</span><br><span class="line">  --cpuset-cpus                   CPUs in which to allow execution (0-3, 0,1)</span><br><span class="line">  --cpuset-mems                   MEMs in which to allow execution (0-3, 0,1)</span><br><span class="line">  -d, --detach                    Run container in background and print container ID</span><br><span class="line">  --detach-keys                   Override the key sequence for detaching a container</span><br><span class="line">  --device=[]                     Add a host device to the container</span><br><span class="line">  --device-read-bps=[]            Limit read rate (bytes per second) from a device</span><br><span class="line">  --device-read-iops=[]           Limit read rate (IO per second) from a device</span><br><span class="line">  --device-write-bps=[]           Limit write rate (bytes per second) to a device</span><br><span class="line">  --device-write-iops=[]          Limit write rate (IO per second) to a device</span><br><span class="line">  --disable-content-trust=true    Skip image verification</span><br><span class="line">  --dns=[]                        Set custom DNS servers</span><br><span class="line">  --dns-opt=[]                    Set DNS options</span><br><span class="line">  --dns-search=[]                 Set custom DNS search domains</span><br><span class="line">  -e, --env=[]                    Set environment variables</span><br><span class="line">  --entrypoint                    Overwrite the default ENTRYPOINT of the image</span><br><span class="line">  --env-file=[]                   Read in a file of environment variables</span><br><span class="line">  --expose=[]                     Expose a port or a range of ports</span><br><span class="line">  --group-add=[]                  Add additional groups to join</span><br><span class="line">  -h, --hostname                  Container host name</span><br><span class="line">  --help                          Print usage</span><br><span class="line">  -i, --interactive               Keep STDIN open even if not attached</span><br><span class="line">  --ip                            Container IPv4 address (e.g. 172.30.100.104)</span><br><span class="line">  --ip6                           Container IPv6 address (e.g. 2001:db8::33)</span><br><span class="line">  --ipc                           IPC namespace to use</span><br><span class="line">  --isolation                     Container isolation level</span><br><span class="line">  --kernel-memory                 Kernel memory limit</span><br><span class="line">  -l, --label=[]                  Set meta data on a container</span><br><span class="line">  --label-file=[]                 Read in a line delimited file of labels</span><br><span class="line">  --link=[]                       Add link to another container</span><br><span class="line">  --log-driver                    Logging driver for container</span><br><span class="line">  --log-opt=[]                    Log driver options</span><br><span class="line">  -m, --memory                    Memory limit</span><br><span class="line">  --mac-address                   Container MAC address (e.g. 92:d0:c6:0a:29:33)</span><br><span class="line">  --memory-reservation            Memory soft limit</span><br><span class="line">  --memory-swap                   Swap limit equal to memory plus swap: &#x27;-1&#x27; to enable unlimited swap</span><br><span class="line">  --memory-swappiness=-1          Tune container memory swappiness (0 to 100)</span><br><span class="line">  --name                          Assign a name to the container</span><br><span class="line">  --net=default                   Connect a container to a network</span><br><span class="line">  --net-alias=[]                  Add network-scoped alias for the container</span><br><span class="line">  --oom-kill-disable              Disable OOM Killer</span><br><span class="line">  --oom-score-adj                 Tune host&#x27;s OOM preferences (-1000 to 1000)</span><br><span class="line">  -P, --publish-all               Publish all exposed ports to random ports</span><br><span class="line">  -p, --publish=[]                Publish a container&#x27;s port(s) to the host</span><br><span class="line">  --pid                           PID namespace to use</span><br><span class="line">  --privileged                    Give extended privileges to this container</span><br><span class="line">  --read-only                     Mount the container&#x27;s root filesystem as read only</span><br><span class="line">  --restart=no                    Restart policy to apply when a container exits</span><br><span class="line">  --rm                            Automatically remove the container when it exits</span><br><span class="line">  --security-opt=[]               Security Options</span><br><span class="line">  --shm-size                      Size of /dev/shm, default value is 64MB</span><br><span class="line">  --sig-proxy=true                Proxy received signals to the process</span><br><span class="line">  --stop-signal=SIGTERM           Signal to stop a container, SIGTERM by default</span><br><span class="line">  -t, --tty                       Allocate a pseudo-TTY</span><br><span class="line">  --tmpfs=[]                      Mount a tmpfs directory</span><br><span class="line">  -u, --user                      Username or UID (format: &lt;name|uid&gt;[:&lt;group|gid&gt;])</span><br><span class="line">  --ulimit=[]                     Ulimit options</span><br><span class="line">  --uts                           UTS namespace to use</span><br><span class="line">  -v, --volume=[]                 Bind mount a volume</span><br><span class="line">  --volume-driver                 Optional volume driver for the container</span><br><span class="line">  --volumes-from=[]               Mount volumes from the specified container(s)</span><br><span class="line">  -w, --workdir                   Working directory inside the container</span><br></pre></td></tr></table></figure>
<p><code>IMAGE</code>可以为镜像名或者镜像ID。<br>示例： </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run -t -i ouruser/sinatra:v2 /bin/bash</span><br><span class="line">sudo docker run -d ubuntu:14.04 /bin/sh -c &quot;while true; do echo hello world; sleep 1; done&quot; #守护态运行</span><br></pre></td></tr></table></figure>

<p>在执行 docker run 的时候如果添加 –rm 标记，则容器在终止后会立刻删除。注意，–rm 和 -d 参数不能同时使用。</p>
<h3 id="docker-logs"><a href="#docker-logs" class="headerlink" title="docker logs"></a>docker logs</h3><p><code>说明：</code>获取容器输出的信息，适用于守护态运行docker容器。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker logs --help</span><br><span class="line"></span><br><span class="line">Usage:	docker logs [OPTIONS] CONTAINER</span><br><span class="line"></span><br><span class="line">Fetch the logs of a container</span><br><span class="line"></span><br><span class="line">  -f, --follow        Follow log output</span><br><span class="line">  --help              Print usage</span><br><span class="line">  --since             Show logs since timestamp</span><br><span class="line">  -t, --timestamps    Show timestamps</span><br><span class="line">  --tail=all          Number of lines to show from the end of the logs</span><br></pre></td></tr></table></figure>
<h3 id="docker-stop"><a href="#docker-stop" class="headerlink" title="docker stop"></a>docker stop</h3><p><code>说明：</code>停止一个正在启动的容器。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker stop --help</span><br><span class="line"></span><br><span class="line">Usage:	docker stop [OPTIONS] CONTAINER [CONTAINER...]</span><br><span class="line"></span><br><span class="line">Stop a running container.</span><br><span class="line">Sending SIGTERM and then SIGKILL after a grace period</span><br><span class="line"></span><br><span class="line">  --help             Print usage</span><br><span class="line">  -t, --time=10      Seconds to wait for stop before killing it</span><br></pre></td></tr></table></figure>
<h3 id="docker-start"><a href="#docker-start" class="headerlink" title="docker start"></a>docker start</h3><p><code>说明：</code>启动一个已经停止的容器。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker start --help</span><br><span class="line"></span><br><span class="line">Usage:	docker start [OPTIONS] CONTAINER [CONTAINER...]</span><br><span class="line"></span><br><span class="line">Start one or more stopped containers</span><br><span class="line"></span><br><span class="line">  -a, --attach         Attach STDOUT/STDERR and forward signals</span><br><span class="line">  --detach-keys        Override the key sequence for detaching a container</span><br><span class="line">  --help               Print usage</span><br><span class="line">  -i, --interactive    Attach container&#x27;s STDIN</span><br></pre></td></tr></table></figure>
<h3 id="docker-restart"><a href="#docker-restart" class="headerlink" title="docker restart"></a>docker restart</h3><p><code>说明：</code>将一个运行态的容器终止，然后再重新启动它。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker restart --help</span><br><span class="line"></span><br><span class="line">Usage:	docker restart [OPTIONS] CONTAINER [CONTAINER...]</span><br><span class="line"></span><br><span class="line">Restart a container</span><br><span class="line"></span><br><span class="line">  --help             Print usage</span><br><span class="line">  -t, --time=10      Seconds to wait for stop before killing the container</span><br></pre></td></tr></table></figure>
<h3 id="docker-attach"><a href="#docker-attach" class="headerlink" title="docker attach"></a>docker attach</h3><p><code>说明：</code>在使用 -d 参数时，容器启动后会进入后台。 某些时候需要进入容器进行操作就可以用它。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker attach --help</span><br><span class="line"></span><br><span class="line">Usage:	docker attach [OPTIONS] CONTAINER</span><br><span class="line"></span><br><span class="line">Attach to a running container</span><br><span class="line"></span><br><span class="line">  --detach-keys       Override the key sequence for detaching a container</span><br><span class="line">  --help              Print usage</span><br><span class="line">  --no-stdin          Do not attach STDIN</span><br><span class="line">  --sig-proxy=true    Proxy all received signals to the process</span><br></pre></td></tr></table></figure>

<h3 id="docker-commit"><a href="#docker-commit" class="headerlink" title="docker commit"></a>docker commit</h3><p><code>说明：</code>将修改后的容器提交保存为一个新的镜像。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker commit --help</span><br><span class="line"></span><br><span class="line">Usage:	docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]</span><br><span class="line"></span><br><span class="line">Create a new image from a container&#x27;s changes</span><br><span class="line"></span><br><span class="line">  -a, --author        Author (e.g., &quot;John Hannibal Smith &lt;hannibal@a-team.com&gt;&quot;)</span><br><span class="line">  -c, --change=[]     Apply Dockerfile instruction to the created image</span><br><span class="line">  --help              Print usage</span><br><span class="line">  -m, --message       Commit message</span><br><span class="line">  -p, --pause=true    Pause container during commit</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker commit -m &quot;Added json gem&quot; -a &quot;Docker Newbee&quot; 0b2616b0e5a8 ouruser/sinatra:v2</span><br><span class="line">4f177bd27a9ff0f6dc2a830403925b5360bfe0b93d476f7fc3231110e7f71b1c</span><br></pre></td></tr></table></figure>
<h3 id="docker-tag"><a href="#docker-tag" class="headerlink" title="docker tag"></a>docker tag</h3><p><code>说明:</code>修改镜像标签</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker tag --help</span><br><span class="line"></span><br><span class="line">Usage:	docker tag [OPTIONS] IMAGE[:TAG] [REGISTRYHOST/][USERNAME/]NAME[:TAG]</span><br><span class="line"></span><br><span class="line">Tag an image into a repository</span><br><span class="line"></span><br><span class="line">  --help             Print usage</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag 5db5f8471261 ouruser/sinatra:devel #将5db5f8471261的镜像tag更改为devel</span><br></pre></td></tr></table></figure>
<h3 id="docker-push"><a href="#docker-push" class="headerlink" title="docker push"></a>docker push</h3><p><code>说明:</code>自己创建的本地镜像上传到远程仓库中来共享。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker push --help</span><br><span class="line"></span><br><span class="line">Usage:	docker push [OPTIONS] NAME[:TAG]</span><br><span class="line"></span><br><span class="line">Push an image or a repository to a registry</span><br><span class="line"></span><br><span class="line">  --disable-content-trust=true    Skip image signing</span><br><span class="line">  --help                          Print usage</span><br></pre></td></tr></table></figure>
<h3 id="docker-save"><a href="#docker-save" class="headerlink" title="docker save"></a>docker save</h3><p><code>说明:</code>将镜像导出成本地文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker save --help</span><br><span class="line"></span><br><span class="line">Usage:	docker save [OPTIONS] IMAGE [IMAGE...]</span><br><span class="line"></span><br><span class="line">Save an image(s) to a tar archive (streamed to STDOUT by default)</span><br><span class="line"></span><br><span class="line">  --help             Print usage</span><br><span class="line">  -o, --output       Write to a file, instead of STDOUT</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker save -o ubuntu_14.04.tar ubuntu:14.04</span><br></pre></td></tr></table></figure>
<h3 id="docker-load"><a href="#docker-load" class="headerlink" title="docker load"></a>docker load</h3><p><code>说明:</code>将镜像本地文件加载成为本地镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker load --help</span><br><span class="line"></span><br><span class="line">Usage:	docker load [OPTIONS]</span><br><span class="line"></span><br><span class="line">Load an image from a tar archive or STDIN</span><br><span class="line"></span><br><span class="line">  --help             Print usage</span><br><span class="line">  -i, --input        Read from a tar archive file, instead of STDIN</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker load --input ubuntu_14.04.tar</span><br></pre></td></tr></table></figure>
<h3 id="docker-ps"><a href="#docker-ps" class="headerlink" title="docker ps"></a>docker ps</h3><p><code>说明：</code>列出对应的容器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker ps --help</span><br><span class="line"></span><br><span class="line">Usage:	docker ps [OPTIONS]</span><br><span class="line"></span><br><span class="line">List containers</span><br><span class="line"></span><br><span class="line">  -a, --all          Show all containers (default shows just running)</span><br><span class="line">  -f, --filter=[]    Filter output based on conditions provided</span><br><span class="line">  --format           Pretty-print containers using a Go template</span><br><span class="line">  --help             Print usage</span><br><span class="line">  -l, --latest       Show the latest created container (includes all states)</span><br><span class="line">  -n=-1              Show n last created containers (includes all states)</span><br><span class="line">  --no-trunc         Don&#x27;t truncate output</span><br><span class="line">  -q, --quiet        Only display numeric IDs</span><br><span class="line">  -s, --size         Display total file sizes</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker ps -a</span><br></pre></td></tr></table></figure>
<h3 id="docker-export"><a href="#docker-export" class="headerlink" title="docker export"></a>docker export</h3><p><code>说明：</code>导出本地某个容器为快照文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker export --help</span><br><span class="line"></span><br><span class="line">Usage:	docker export [OPTIONS] CONTAINER</span><br><span class="line"></span><br><span class="line">Export a container&#x27;s filesystem as a tar archive</span><br><span class="line"></span><br><span class="line">  --help             Print usage</span><br><span class="line">  -o, --output       Write to a file, instead of STDOUT</span><br></pre></td></tr></table></figure>
<h3 id="docker-import"><a href="#docker-import" class="headerlink" title="docker import"></a>docker import</h3><p><code>说明：</code>将容器快照文件导入为本地容器或者本地镜像。与<code>docker load</code>的区别在于容器快照文件将丢弃所有的历史记录和元数据信息,而镜像存储文件将保存完整记录，体积也要大。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker import --help</span><br><span class="line"></span><br><span class="line">Usage:	docker import [OPTIONS] file|URL|- [REPOSITORY[:TAG]]</span><br><span class="line"></span><br><span class="line">Import the contents from a tarball to create a filesystem image</span><br><span class="line"></span><br><span class="line">  -c, --change=[]    Apply Dockerfile instruction to the created image</span><br><span class="line">  --help             Print usage</span><br><span class="line">  -m, --message      Set commit message for imported image</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cat ubuntu.tar | sudo docker import - test/ubuntu:v1.0</span><br></pre></td></tr></table></figure>
<h3 id="docker-rm"><a href="#docker-rm" class="headerlink" title="docker rm"></a>docker rm</h3><p><code>说明：</code>移除容器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker rm --help</span><br><span class="line"></span><br><span class="line">Usage:	docker rm [OPTIONS] CONTAINER [CONTAINER...]</span><br><span class="line"></span><br><span class="line">Remove one or more containers</span><br><span class="line"></span><br><span class="line">  -f, --force        Force the removal of a running container (uses SIGKILL)</span><br><span class="line">  --help             Print usage</span><br><span class="line">  -l, --link         Remove the specified link</span><br><span class="line">  -v, --volumes      Remove the volumes associated with the container</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker rm $(docker ps -a -q) #清理所有处于终止状态的容器</span><br></pre></td></tr></table></figure>
<h3 id="docker-rmi"><a href="#docker-rmi" class="headerlink" title="docker rmi"></a>docker rmi</h3><p><code>说明:</code>移除本地镜像，移出前需要先移除到镜像对应的容器。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker rmi --help</span><br><span class="line"></span><br><span class="line">Usage:	docker rmi [OPTIONS] IMAGE [IMAGE...]</span><br><span class="line"></span><br><span class="line">Remove one or more images</span><br><span class="line"></span><br><span class="line">  -f, --force        Force removal of the image</span><br><span class="line">  --help             Print usage</span><br><span class="line">  --no-prune         Do not delete untagged parents</span><br></pre></td></tr></table></figure>

<p>清理所有未打过标签的本地镜像：<code>docker rmi $(docker images -q -f &quot;dangling=true&quot;)</code></p>
<h3 id="docker-inspect"><a href="#docker-inspect" class="headerlink" title="docker inspect"></a>docker inspect</h3><p><code>说明:</code>查看容器或者镜像的详情信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker inspect --help</span><br><span class="line"></span><br><span class="line">Usage:	docker inspect [OPTIONS] CONTAINER|IMAGE [CONTAINER|IMAGE...]</span><br><span class="line"></span><br><span class="line">Return low-level information on a container or image</span><br><span class="line"></span><br><span class="line">  -f, --format       Format the output using the given go template</span><br><span class="line">  --help             Print usage</span><br><span class="line">  -s, --size         Display total file sizes if the type is container</span><br><span class="line">  --type             Return JSON for specified type, (e.g image or container)</span><br></pre></td></tr></table></figure>
<h3 id="docker-port"><a href="#docker-port" class="headerlink" title="docker port"></a>docker port</h3><p><code>说明：</code>来查看当前映射的端口配置，也可以查看到绑定的地址。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker port --help</span><br><span class="line"></span><br><span class="line">Usage:  docker port [OPTIONS] CONTAINER [PRIVATE_PORT[/PROTO]]</span><br><span class="line"></span><br><span class="line">List port mappings or a specific mapping for the CONTAINER</span><br><span class="line"></span><br><span class="line">  --help             Print usage</span><br></pre></td></tr></table></figure>

<hr>
<p><em>观点仅代表自己，期待你的留言。</em></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-string-format" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/13/string-format/" class="article-date">
  	<time datetime="2016-04-13T08:02:59.000Z" itemprop="datePublished">2016-04-13</time>
</a>
      <div class="analysis-container">
	<i class="fa fa-line-chart"></i>
	已阅读<span id=“busuanzi_container_page_pv”><span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span></span> 次
</div>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/13/string-format/">String.format详解</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
              
        <p>String类的format()方法用于创建格式化的字符串以及连接多个字符串对象。熟悉C语言的同学应该记得C语言的sprintf()方法，两者有类似之处。format()方法有两种重载形式。<br>format(String format, Object… args) 新字符串使用本地语言环境，制定字符串格式和参数生成格式化的新字符串。</p>
<p>format(Locale locale, String format, Object… args) 使用指定的语言环境，制定字符串格式和参数生成格式化的字符串。</p>
<h2 id="常规类型的格式化"><a href="#常规类型的格式化" class="headerlink" title="常规类型的格式化"></a>常规类型的格式化</h2><table>
<thead>
<tr>
<th align="left">转换符</th>
<th align="left">说明</th>
<th align="left">示例</th>
</tr>
</thead>
<tbody><tr>
<td align="left">%s</td>
<td align="left">字符串类型</td>
<td align="left">“mingrisoft”</td>
</tr>
<tr>
<td align="left">%c</td>
<td align="left">字符类型</td>
<td align="left">‘m’</td>
</tr>
<tr>
<td align="left">%b</td>
<td align="left">布尔类型</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">%d</td>
<td align="left">整数类型（十进制）</td>
<td align="left">99</td>
</tr>
<tr>
<td align="left">%x</td>
<td align="left">整数类型（十六进制）</td>
<td align="left">FF</td>
</tr>
<tr>
<td align="left">%o</td>
<td align="left">整数类型（八进制）</td>
<td align="left">77</td>
</tr>
<tr>
<td align="left">%f</td>
<td align="left">浮点类型</td>
<td align="left">99.99</td>
</tr>
<tr>
<td align="left">%a</td>
<td align="left">十六进制浮点类型</td>
<td align="left">FF.35AE</td>
</tr>
<tr>
<td align="left">%e</td>
<td align="left">指数类型</td>
<td align="left">9.38e+5</td>
</tr>
<tr>
<td align="left">%g</td>
<td align="left">通用浮点类型（f和e类型中较短的）</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">%h</td>
<td align="left">散列码</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">%%</td>
<td align="left">百分比类型</td>
<td align="left">％</td>
</tr>
<tr>
<td align="left">%n</td>
<td align="left">换行符</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">%tx</td>
<td align="left">日期与时间类型（x代表不同的日期与时间转换符）</td>
<td align="left"></td>
</tr>
</tbody></table>
<p>测试代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;  </span><br><span class="line">    String str=null;  </span><br><span class="line">    str=String.format(&quot;Hi,%s&quot;, &quot;王力&quot;);  </span><br><span class="line">    System.out.println(str);  </span><br><span class="line">    str=String.format(&quot;Hi,%s:%s.%s&quot;, &quot;王南&quot;,&quot;王力&quot;,&quot;王张&quot;);            </span><br><span class="line">    System.out.println(str);                           </span><br><span class="line">    System.out.printf(&quot;字母a的大写是：%c %n&quot;, &#x27;A&#x27;);  </span><br><span class="line">    System.out.printf(&quot;3&gt;7的结果是：%b %n&quot;, 3&gt;7);  </span><br><span class="line">    System.out.printf(&quot;100的一半是：%d %n&quot;, 100/2);  </span><br><span class="line">    System.out.printf(&quot;100的16进制数是：%x %n&quot;, 100);  </span><br><span class="line">    System.out.printf(&quot;100的8进制数是：%o %n&quot;, 100);  </span><br><span class="line">    System.out.printf(&quot;50元的书打8.5折扣是：%f 元%n&quot;, 50*0.85);  </span><br><span class="line">    System.out.printf(&quot;上面价格的16进制数是：%a %n&quot;, 50*0.85);  </span><br><span class="line">    System.out.printf(&quot;上面价格的指数表示：%e %n&quot;, 50*0.85);  </span><br><span class="line">    System.out.printf(&quot;上面价格的指数和浮点数结果的长度较短的是：%g %n&quot;, 50*0.85);  </span><br><span class="line">    System.out.printf(&quot;上面的折扣是%d%% %n&quot;, 85);  </span><br><span class="line">    System.out.printf(&quot;字母A的散列码是：%h %n&quot;, &#x27;A&#x27;);  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p>输出结果:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Hi,王力  </span><br><span class="line">Hi,王南:王力.王张  </span><br><span class="line">字母a的大写是：A   </span><br><span class="line">3&gt;7的结果是：false   </span><br><span class="line">100的一半是：50   </span><br><span class="line">100的16进制数是：64   </span><br><span class="line">100的8进制数是：144   </span><br><span class="line">50元的书打8.5折扣是：42.500000 元  </span><br><span class="line">上面价格的16进制数是：0x1.54p5   </span><br><span class="line">上面价格的指数表示：4.250000e+01   </span><br><span class="line">上面价格的指数和浮点数结果的长度较短的是：42.5000   </span><br><span class="line">上面的折扣是85%   </span><br><span class="line">字母A的散列码是：41  </span><br></pre></td></tr></table></figure>
<p>搭配转换符的标志，如图所示:</p>
<table>
<thead>
<tr>
<th align="left">标志</th>
<th align="left">说明</th>
<th align="left">示例</th>
<th align="left">结果</th>
</tr>
</thead>
<tbody><tr>
<td align="left">+</td>
<td align="left">为正数或者负数添加符号</td>
<td align="left">(“%+d”,15)</td>
<td align="left">+15</td>
</tr>
<tr>
<td align="left">−</td>
<td align="left">左对齐</td>
<td align="left">(“%-5d”,15)</td>
<td align="left">15</td>
</tr>
<tr>
<td align="left">0</td>
<td align="left">数字前面补0</td>
<td align="left">(“%04d”, 99)</td>
<td align="left">0099</td>
</tr>
<tr>
<td align="left">空格</td>
<td align="left">在整数之前添加指定数量的空格</td>
<td align="left">(“% 4d”, 99)</td>
<td align="left">99</td>
</tr>
<tr>
<td align="left">,</td>
<td align="left">以“,”对数字分组</td>
<td align="left">(“%,f”, 9999.99)</td>
<td align="left">9,999.990000</td>
</tr>
<tr>
<td align="left">(</td>
<td align="left">使用括号包含负数</td>
<td align="left">(“%(f”, -99.99)</td>
<td align="left">(99.990000)</td>
</tr>
<tr>
<td align="left">#</td>
<td align="left">如果是浮点数则包含小数点，如果是16进制或8进制则添加0x或0</td>
<td align="left">(“%#x”, 99)</td>
<td align="left">0x63</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left">(“%#o”, 99)</td>
<td align="left">0143</td>
</tr>
<tr>
<td align="left">&lt;</td>
<td align="left">格式化前一个转换符所描述的参数</td>
<td align="left">(“%f和%&lt;3.2f”, 99.45)</td>
<td align="left">99.450000和99.45</td>
</tr>
<tr>
<td align="left">$</td>
<td align="left">被格式化的参数索引</td>
<td align="left">(“%1$d,%2$s”, 99,”abc”)</td>
<td align="left">99,abc</td>
</tr>
<tr>
<td align="left">测试代码：</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;  </span><br><span class="line">    String str=null;  </span><br><span class="line">    //$使用  </span><br><span class="line">    str=String.format(&quot;格式参数$的使用：%1$d,%2$s&quot;, 99,&quot;abc&quot;);             </span><br><span class="line">    System.out.println(str);                       </span><br><span class="line">    //+使用  </span><br><span class="line">    System.out.printf(&quot;显示正负数的符号：%+d与%d%n&quot;, 99,-99);  </span><br><span class="line">    //补O使用  </span><br><span class="line">    System.out.printf(&quot;最牛的编号是：%03d%n&quot;, 7);  </span><br><span class="line">    //空格使用  </span><br><span class="line">    System.out.printf(&quot;Tab键的效果是：% 8d%n&quot;, 7);  </span><br><span class="line">    //.使用  </span><br><span class="line">    System.out.printf(&quot;整数分组的效果是：%,d%n&quot;, 9989997);  </span><br><span class="line">    //空格和小数点后面个数  </span><br><span class="line">    System.out.printf(&quot;一本书的价格是：% 50.5f元%n&quot;, 49.8);  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p>输出结果:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">格式参数$的使用：99,abc  </span><br><span class="line">显示正负数的符号：+99与-99  </span><br><span class="line">最牛的编号是：007  </span><br><span class="line">Tab键的效果是：       7  </span><br><span class="line">整数分组的效果是：9,989,997  </span><br><span class="line">一本书的价格是：                                          49.80000元</span><br></pre></td></tr></table></figure>

<h2 id="日期和事件字符串格式化"><a href="#日期和事件字符串格式化" class="headerlink" title="日期和事件字符串格式化"></a>日期和事件字符串格式化</h2><p>在程序界面中经常需要显示时间和日期，但是其显示的 格式经常不尽人意，需要编写大量的代码经过各种算法才得到理想的日期与时间格式。字符串格式中还有%tx转换符没有详细介绍，它是专门用来格式化日期和时 间的。%tx转换符中的x代表另外的处理日期和时间格式的转换符，它们的组合能够将日期和时间格式化成多种格式。</p>
<p>常见日期和时间组合的格式，如表所示。</p>
<table>
<thead>
<tr>
<th align="left">转换符</th>
<th align="left">说明</th>
<th align="left">示例</th>
</tr>
</thead>
<tbody><tr>
<td align="left">c</td>
<td align="left">包括全部日期和时间信息</td>
<td align="left">星期六 十月 27 14:21:20 CST 2007</td>
</tr>
<tr>
<td align="left">F</td>
<td align="left">“年-月-日”格式</td>
<td align="left">2007-10-27</td>
</tr>
<tr>
<td align="left">D</td>
<td align="left">“月/日/年”格式</td>
<td align="left">10/27/07</td>
</tr>
<tr>
<td align="left">r</td>
<td align="left">“HH:MM:SS PM”格式（12时制）</td>
<td align="left">02:25:51 下午</td>
</tr>
<tr>
<td align="left">T</td>
<td align="left">“HH:MM:SS”格式（24时制）</td>
<td align="left">14:28:16</td>
</tr>
<tr>
<td align="left">R</td>
<td align="left">“HH:MM”格式（24时制）</td>
<td align="left">14:28</td>
</tr>
</tbody></table>
<p>测试代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;  </span><br><span class="line">    Date date=new Date();                                  </span><br><span class="line">    //c的使用  </span><br><span class="line">    System.out.printf(&quot;全部日期和时间信息：%tc%n&quot;,date);          </span><br><span class="line">    //f的使用  </span><br><span class="line">    System.out.printf(&quot;年-月-日格式：%tF%n&quot;,date);  </span><br><span class="line">    //d的使用  </span><br><span class="line">    System.out.printf(&quot;月/日/年格式：%tD%n&quot;,date);  </span><br><span class="line">    //r的使用  </span><br><span class="line">    System.out.printf(&quot;HH:MM:SS PM格式（12时制）：%tr%n&quot;,date);  </span><br><span class="line">    //t的使用  </span><br><span class="line">    System.out.printf(&quot;HH:MM:SS格式（24时制）：%tT%n&quot;,date);  </span><br><span class="line">    //R的使用  </span><br><span class="line">    System.out.printf(&quot;HH:MM格式（24时制）：%tR&quot;,date);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">全部日期和时间信息：星期一 九月 10 10:43:36 CST 2012  </span><br><span class="line">年-月-日格式：2012-09-10  </span><br><span class="line">月/日/年格式：09/10/12  </span><br><span class="line">HH:MM:SS PM格式（12时制）：10:43:36 上午  </span><br><span class="line">HH:MM:SS格式（24时制）：10:43:36  </span><br><span class="line">HH:MM格式（24时制）：10:43  </span><br></pre></td></tr></table></figure>
<p>定义日期格式的转换符可以使日期通过指定的转换符生成新字符串。这些日期转换符如图所示。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;  </span><br><span class="line">    Date date=new Date();                                      </span><br><span class="line">    //b的使用，月份简称  </span><br><span class="line">    String str=String.format(Locale.US,&quot;英文月份简称：%tb&quot;,date);       </span><br><span class="line">    System.out.println(str);                                                                              </span><br><span class="line">    System.out.printf(&quot;本地月份简称：%tb%n&quot;,date);  </span><br><span class="line">    //B的使用，月份全称  </span><br><span class="line">    str=String.format(Locale.US,&quot;英文月份全称：%tB&quot;,date);  </span><br><span class="line">    System.out.println(str);  </span><br><span class="line">    System.out.printf(&quot;本地月份全称：%tB%n&quot;,date);  </span><br><span class="line">    //a的使用，星期简称  </span><br><span class="line">    str=String.format(Locale.US,&quot;英文星期的简称：%ta&quot;,date);  </span><br><span class="line">    System.out.println(str);  </span><br><span class="line">    //A的使用，星期全称  </span><br><span class="line">    System.out.printf(&quot;本地星期的简称：%tA%n&quot;,date);  </span><br><span class="line">    //C的使用，年前两位  </span><br><span class="line">    System.out.printf(&quot;年的前两位数字（不足两位前面补0）：%tC%n&quot;,date);  </span><br><span class="line">    //y的使用，年后两位  </span><br><span class="line">    System.out.printf(&quot;年的后两位数字（不足两位前面补0）：%ty%n&quot;,date);  </span><br><span class="line">    //j的使用，一年的天数  </span><br><span class="line">    System.out.printf(&quot;一年中的天数（即年的第几天）：%tj%n&quot;,date);  </span><br><span class="line">    //m的使用，月份  </span><br><span class="line">    System.out.printf(&quot;两位数字的月份（不足两位前面补0）：%tm%n&quot;,date);  </span><br><span class="line">    //d的使用，日（二位，不够补零）  </span><br><span class="line">    System.out.printf(&quot;两位数字的日（不足两位前面补0）：%td%n&quot;,date);  </span><br><span class="line">    //e的使用，日（一位不补零）  </span><br><span class="line">    System.out.printf(&quot;月份的日（前面不补0）：%te&quot;,date);  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">英文月份简称：Sep  </span><br><span class="line">本地月份简称：九月  </span><br><span class="line">英文月份全称：September  </span><br><span class="line">本地月份全称：九月  </span><br><span class="line">英文星期的简称：Mon  </span><br><span class="line">本地星期的简称：星期一  </span><br><span class="line">年的前两位数字（不足两位前面补0）：20  </span><br><span class="line">年的后两位数字（不足两位前面补0）：12  </span><br><span class="line">一年中的天数（即年的第几天）：254  </span><br><span class="line">两位数字的月份（不足两位前面补0）：09  </span><br><span class="line">两位数字的日（不足两位前面补0）：10  </span><br><span class="line">月份的日（前面不补0）：10  </span><br></pre></td></tr></table></figure>
<p>和日期格式转换符相比，时间格式的转换符要更多、更精确。它可以将时间格式化成时、分、秒甚至时毫秒等单位。格式化时间字符串的转换符如图所示。</p>
<table>
<thead>
<tr>
<th align="left">转换符</th>
<th align="left">说明</th>
<th align="left">示例</th>
</tr>
</thead>
<tbody><tr>
<td align="left">H</td>
<td align="left">2位数字24时制的小时（不足2位前面补0）</td>
<td align="left">15</td>
</tr>
<tr>
<td align="left">I</td>
<td align="left">2位数字12时制的小时（不足2位前面补0）</td>
<td align="left">03</td>
</tr>
<tr>
<td align="left">k</td>
<td align="left">2位数字24时制的小时（前面不补0）</td>
<td align="left">15</td>
</tr>
<tr>
<td align="left">l</td>
<td align="left">2位数字12时制的小时（前面不补0）</td>
<td align="left">3</td>
</tr>
<tr>
<td align="left">M</td>
<td align="left">2位数字的分钟（不足2位前面补0）</td>
<td align="left">03</td>
</tr>
<tr>
<td align="left">S</td>
<td align="left">2位数字的秒（不足2位前面补0）</td>
<td align="left">09</td>
</tr>
<tr>
<td align="left">L</td>
<td align="left">3位数字的毫秒（不足3位前面补0）</td>
<td align="left">015</td>
</tr>
<tr>
<td align="left">N</td>
<td align="left">9位数字的毫秒数（不足9位前面补0）</td>
<td align="left">562000000</td>
</tr>
<tr>
<td align="left">p</td>
<td align="left">小写字母的上午或下午标记</td>
<td align="left">中：下午</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left">英：pm</td>
</tr>
<tr>
<td align="left">z</td>
<td align="left">相对于GMT的RFC822时区的偏移量</td>
<td align="left">+0800</td>
</tr>
<tr>
<td align="left">Z</td>
<td align="left">时区缩写字符串</td>
<td align="left">CST</td>
</tr>
<tr>
<td align="left">s</td>
<td align="left">1970-1-1 00:00:00 到现在所经过的秒数</td>
<td align="left">1193468128</td>
</tr>
<tr>
<td align="left">Q</td>
<td align="left">1970-1-1 00:00:00 到现在所经过的毫秒数</td>
<td align="left">1193468128984</td>
</tr>
<tr>
<td align="left">示例：</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;  </span><br><span class="line">    Date date = new Date();  </span><br><span class="line">    //H的使用  </span><br><span class="line">    System.out.printf(&quot;2位数字24时制的小时（不足2位前面补0）:%tH%n&quot;, date);  </span><br><span class="line">    //I的使用  </span><br><span class="line">    System.out.printf(&quot;2位数字12时制的小时（不足2位前面补0）:%tI%n&quot;, date);  </span><br><span class="line">    //k的使用  </span><br><span class="line">    System.out.printf(&quot;2位数字24时制的小时（前面不补0）:%tk%n&quot;, date);  </span><br><span class="line">    //l的使用  </span><br><span class="line">    System.out.printf(&quot;2位数字12时制的小时（前面不补0）:%tl%n&quot;, date);  </span><br><span class="line">    //M的使用  </span><br><span class="line">    System.out.printf(&quot;2位数字的分钟（不足2位前面补0）:%tM%n&quot;, date);  </span><br><span class="line">    //S的使用  </span><br><span class="line">    System.out.printf(&quot;2位数字的秒（不足2位前面补0）:%tS%n&quot;, date);  </span><br><span class="line">    //L的使用  </span><br><span class="line">    System.out.printf(&quot;3位数字的毫秒（不足3位前面补0）:%tL%n&quot;, date);  </span><br><span class="line">    //N的使用  </span><br><span class="line">    System.out.printf(&quot;9位数字的毫秒数（不足9位前面补0）:%tN%n&quot;, date);  </span><br><span class="line">    //p的使用  </span><br><span class="line">    String str = String.format(Locale.US, &quot;小写字母的上午或下午标记(英)：%tp&quot;, date);  </span><br><span class="line">    System.out.println(str);   </span><br><span class="line">    System.out.printf(&quot;小写字母的上午或下午标记（中）：%tp%n&quot;, date);  </span><br><span class="line">    //z的使用  </span><br><span class="line">    System.out.printf(&quot;相对于GMT的RFC822时区的偏移量:%tz%n&quot;, date);  </span><br><span class="line">    //Z的使用  </span><br><span class="line">    System.out.printf(&quot;时区缩写字符串:%tZ%n&quot;, date);  </span><br><span class="line">    //s的使用  </span><br><span class="line">    System.out.printf(&quot;1970-1-1 00:00:00 到现在所经过的秒数：%ts%n&quot;, date);  </span><br><span class="line">    //Q的使用  </span><br><span class="line">    System.out.printf(&quot;1970-1-1 00:00:00 到现在所经过的毫秒数：%tQ%n&quot;, date);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">2位数字24时制的小时（不足2位前面补0）:11  </span><br><span class="line">2位数字12时制的小时（不足2位前面补0）:11  </span><br><span class="line">2位数字24时制的小时（前面不补0）:11  </span><br><span class="line">2位数字12时制的小时（前面不补0）:11  </span><br><span class="line">2位数字的分钟（不足2位前面补0）:03  </span><br><span class="line">2位数字的秒（不足2位前面补0）:52  </span><br><span class="line">3位数字的毫秒（不足3位前面补0）:773  </span><br><span class="line">9位数字的毫秒数（不足9位前面补0）:773000000  </span><br><span class="line">小写字母的上午或下午标记(英)：am  </span><br><span class="line">小写字母的上午或下午标记（中）：上午  </span><br><span class="line">相对于GMT的RFC822时区的偏移量:+0800  </span><br><span class="line">时区缩写字符串:CST  </span><br><span class="line">1970-1-1 00:00:00 到现在所经过的秒数：1347246232  </span><br><span class="line">1970-1-1 00:00:00 到现在所经过的毫秒数：1347246232773  </span><br></pre></td></tr></table></figure>

<hr>
<p><em>观点仅代表自己，期待你的留言。</em></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/7/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/9/">下一页</a>
    </nav>
  

</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2024 建均笔记
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/require-2.1.6,jquery-1.9.1.min.js"></script>


<script src="/js/main.js"></script>



<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'true', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




<link href="//cdn.bootcss.com/highlight.js/8.0/styles/tomorrow-night-bright.min.css" rel="stylesheet">  
<script src="//cdn.bootcss.com/highlight.js/8.0/highlight.min.js"></script>  
<script> 
jQuery('td.code pre').each(function(i, block) {
  hljs.highlightBlock(block);
});
</script>


  </div>
</body>
</html>